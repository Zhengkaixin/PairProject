<!DOCTYPE html>

<html>

<head>

  <meta charset="utf-8">

  <title>论文查询</title>

  <meta name="renderer" content="webkit">

  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <link rel="stylesheet" href="../layui-v2.5.7/layui/css/layui.css"  media="all">

</head>

<body onload="getQueryVariable()">
    <div class="demoTable">
        关键词搜索：
        <div class="layui-inline">
          <input class="layui-input" name="id" id="demoReload" autocomplete="off">
        </div>
        <button type="button" class="layui-btn" data-type="reload">搜索</button>
    </div>

    <table class="layui-table" lay-data="{ height:1000, url:'tableData.json', page:true, id:'idTest'}" lay-filter="demo">
        <thead>
          <tr>
            <th lay-data="{field:'title',fixed: true}">论文标题</th>
            <!-- <th lay-data="{field:'id', width:80, sort: true, fixed: true}">ID</th>
            <th lay-data="{field:'username', width:80}">用户名</th>
            <th lay-data="{field:'sex', width:80, sort: true}">性别</th>
            <th lay-data="{field:'city', width:80}">城市</th>
            <th lay-data="{field:'sign', width:160}">签名</th> -->
            <th lay-data="{fixed: 'right', width:178, align:'center', toolbar: '#barDemo'}"></th>
          </tr>
        </thead>
      </table>

<script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>

<script src="../layui-v2.5.7/layui/layui.js" charset="utf-8"></script>
<!-- <script src="../layui-v2.5.7/layui/layui.all.js" charset="utf-8"></script> -->

<script>

layui.use('table', function(){

  var table = layui.table;
//监听工具条    
    table.on('tool(demo)', function(obj){    //注：tool 是工具条事件名，demo 是 table 原始容器的属性 lay-filter="对应的值"
        var data = obj.data;
        var event=obj.event;
        var tr = obj.tr;
        if(event==='detail'){
            window.location.href="论文列表.html";
        }else if(event==='del'){
            layer.confirm('是否删除',function(index){
                obj.del();
                layer.close(index);   //向服务端发送删除指令
            });
        }
    });


//搜索
var $ = layui.$, active = {
    reload: function(){
      //执行重载
      table.reload('testReload', {
        page: {
          curr: 1 //重新从第 1 页开始
        }
        ,where: {
          key: {
            title: demoReload.val() //动态
          }
        }
      }, 'data');
    }
  };
  
  $('.demoTable .layui-btn').on('click', function(){
    var type = $(this).data('type');
    console.log(active[type]);
    console.log(this);
    active[type] ? active[type].call(this) : '';
  });
});

function getQueryVariable(variable)
{   
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
               var pair = vars[i].split("=");
               if(pair[0] == 'keywords'){  
                   document.getElementById("demoReload").value=pair[1];
                return pair[1];}
              
       }
       return(false);
}

</script>
</body>
</html>